var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,i=(a,t,s)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s,c=(e,a)=>{for(var t in a||(a={}))r.call(a,t)&&i(e,t,a[t]);if(s)for(var t of s(a))n.call(a,t)&&i(e,t,a[t]);return e},o=(e,s)=>a(e,t(s));import{B as l,$ as d,y as f,x as m,A as u,F as p,G as h}from"./vendor.bbf9911b.js";import{N as v,D as b,bs as g,b2 as x,gV as C,ba as w,aN as y,aX as P,d as N,av as k,b6 as j,ag as z,gl as q,gm as I,ch as O,gn as B,s as E,gW as R,dF as S,gX as T,gY as M}from"./index.97b013dd.js";import{l as _,Z as L,f as F,_ as A,$ as D}from"./index.c913271b.js";import{r as H}from"./jsx-runtime_commonjs-proxy.8e94ef61.js";import{P as $}from"./index.5f19ab8a.js";function U(e=0,a=20){return v({clientFunc:b.getContacts,onSuccess:g.RECEIVED_CONTACTS,params:[e,a]})}function V(){return v({clientFunc:b.syncContacts,onSuccess:g.RECEIVED_CONTACTS})}var X=H.jsx;var G=l.exports.forwardRef((function(e,a){return X("svg",o(c({},Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:a},e)),{children:X("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})}))})),W=H.jsx;var Y=l.exports.forwardRef((function(e,a){return W("svg",o(c({},Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:a},e)),{children:W("path",{fillRule:"evenodd",d:"M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z",clipRule:"evenodd"})}))})),Z=H.jsx;var J=l.exports.forwardRef((function(e,a){return Z("svg",o(c({},Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:a},e)),{children:Z("path",{fillRule:"evenodd",d:"M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z",clipRule:"evenodd"})}))})),K=H.jsx;var Q=l.exports.forwardRef((function(e,a){return K("svg",o(c({},Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:a},e)),{children:K("path",{d:"M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3zM6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3 3 0 013.75-2.906z"})}))}));var ee={teamContainer:"mqik-944dff04",teamController:"mqik-d87af3e9",channelContainer:"mqik-f0903c37",teamSidebarRight:"mqik-aa5b732a",sidebarHeader:"mqik-20f5ceda",sidebarBtnBack:"mqik-344dc811",sidebarHeaderTitle:"mqik-9f543ba5",sidebarBtnRefresh:"mqik-275f32e9",friendsContainer:"mqik-578078b5",contactList:"mqik-5f37aa9b",contactListContent:"mqik-1f44389f",item:"mqik-39cff3cb",avatar:"mqik-f4969b15",friendProfilePicture:"mqik-8b1842e9",friendStatusIcon:"mqik-28b53345",contactEmpty:"mqik-f86bd0d6",contactEmptyIcon:"mqik-44c0bd64",emptyIcon:"mqik-2aaf5c69",hintText:"mqik-9ba8fbf5"};var ae=e=>{const a=d(),[t,s]=l.exports.useState(!1),r=_.exports.debounce((async()=>{console.info("loadStatusDebounded");const a=e.contactProfiles.map((e=>e.profile));console.info("profiles",a),await e.actions.loadStatusesForProfilesList(a)}),3e3);l.exports.useEffect((()=>{e.actions.getContacts(0,100)}),[]),l.exports.useEffect((()=>{s(e.contactLoading)}),[e.contactLoading]),l.exports.useEffect((()=>{const a=e.contactProfiles.filter((e=>!e.profile)).map((e=>e.contact.user_id));a.length>0&&e.actions.getProfilesByIds(a)}),[e.contactProfiles]),l.exports.useEffect((()=>{console.info("syncLoading",t),t||r()}),[t]);const n=_.exports.debounce((()=>{s(!1),e.actions.getContacts(0,100)}),5e3);let i=f("div",{className:ee.contactEmpty,children:[m("div",{className:ee.contactEmptyIcon,children:m(Q,{className:ee.emptyIcon})}),f("div",{className:ee.hintText,children:["Danh sách theo dõi trống. ",m("br",{}),"Bấm ",m("strong",{children:"Cập nhật"})," góc trên để lấy danh sách mới nhất."]})]});return e.contactProfiles.length>0&&(i=m("div",{className:ee.contactList,children:m("div",{className:ee.contactListContent,children:e.contactProfiles.map((({contact:t,profile:s,status:r},n)=>f("div",s?{className:u(ee.item),onClick:t=>((t,s)=>{t.preventDefault(),a.push(`/${e.match.params.team}/messages/@${s}`)})(t,s.username),children:[m("div",{className:ee.avatar,children:m($,{src:b.getProfilePictureUrl(s.id,s.last_picture_update),size:"lg",status:r,wrapperClass:ee.friendProfilePicture,newStatusIcon:!1,statusClass:ee.friendStatusIcon})}),m("span",{className:ee.friendsName,children:t.display_name})]}:{className:u(ee.itemEmpty),children:[m("div",{className:ee.avatar}),m("div",{className:ee.name})]},`${t.id}-${n}`)))})})),f(l.exports.Fragment,{children:[f("div",{className:u(ee.sidebarHeader),children:[m("button",{className:u(ee.sidebarBtnBack),onClick:()=>{a.replace(`/${e.match.params.team}`)},children:m(G,{className:ee.sidebarBtnBackIcon})}),m("p",{className:u(ee.sidebarHeaderTitle),children:"Danh sách theo dõi"}),m("button",{className:u(),onClick:()=>{t||(s(!0),e.actions.syncContacts()),n()},children:t?m(J,{className:u(ee.sidebarBtnRefresh,{"u3-animate-spin":t})}):m(Y,{className:u(ee.sidebarBtnRefresh)})})]}),m("div",{className:u(ee.friendsContainer),children:i})]})};var te=p((function(e){const a=x(e),t=C(e),s=Object.values(t).map((a=>({contact:a,profile:w(e,a.user_id),status:y(e,a.user_id)||P.OFFLINE}))),r=!!s.find((e=>!e.profile));return{currentUser:a,currentTeamId:N(e),currentChannelId:k(e),prevTeamId:L(e),teamList:j(e),chatActive:F(e),contactLoading:r,contactProfiles:s}}),(function(e){return{actions:h({selectTeam:z,setPreviousTeamId:q,getTeamByName:I,addUserToTeam:O,setDefaultProfileImage:B,savePreferences:E,syncMe:A,setChatReady:D,getContacts:U,syncContacts:V,getProfilesByIds:R,loadStatusesForProfilesList:S,startPeriodicFriendStatusUpdates:T,stopPeriodicFriendStatusUpdates:M},e)}}))(ae),se=Object.freeze(Object.defineProperty({__proto__:null,default:te},Symbol.toStringTag,{value:"Module"}));export{te as F,U as g,se as i};
