var e=Object.defineProperty,a=Object.defineProperties,n=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,i=(a,n,t)=>n in a?e(a,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[n]=t,o=(e,a)=>{for(var n in a||(a={}))s.call(a,n)&&i(e,n,a[n]);if(t)for(var n of t(a))r.call(a,n)&&i(e,n,a[n]);return e},l=(e,t)=>a(e,n(t)),c=(e,a,n)=>(i(e,"symbol"!=typeof a?a+"":a,n),n);import{w as d,x as h,B as m,A as u,R as p,$ as f,G as b,H as v,Y as g,F as y,V as N,Z as C}from"./vendor.3b6a4709.js";import{a2 as _,p as k,q as x,t as I,G as w,S as M,a3 as R}from"./index.c62655dd.js";import{D as q,b3 as T,d as E,b2 as A,h5 as H,b as P,aa as L,av as j,f as O,gl as D,dP as S,f9 as U,fT as B,bZ as F,dO as G,C as $,bR as V,a7 as J,a2 as W,cM as z,bd as K,h6 as Y,h7 as Z,ey as Q,bE as X,r as ee,dt as ae,bt as ne,h0 as te,g1 as se,dW as re,dS as ie,aS as oe,a9 as le,ba as ce,a6 as de,s as he,g3 as me,dQ as ue,g as pe,gb as fe,a as be,g8 as ve,o as ge,c as ye,Z as Ne,h8 as Ce,h9 as _e,ha as ke}from"./index.afc42351.js";import{P as xe,H as Ie,I as we,h as Me,e as Re,M as qe,a as Te,b as Ee,l as Ae,n as He,C as Pe,W as Le,D as je,o as Oe,F as De}from"./DotsVerticalIcon.0f7c14c1.js";import{r as Se}from"./jsx-runtime_commonjs-proxy.1991ba65.js";import{P as Ue}from"./index.a5ba24b0.js";import{T as Be}from"./Tooltip.7a88a472.js";import{W as Fe}from"./index.f8e5c4dc.js";var Ge=e=>d("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:[d("defs",{children:[h("symbol",{id:"chrome-tab-geometry-left",viewBox:"0 0 214 36",children:h("path",{d:"M17 0h197v36H0v-2c4.5 0 9-3.5 9-8V8c0-4.5 3.5-8 8-8z"})}),h("symbol",{id:"chrome-tab-geometry-right",viewBox:"0 0 214 36",children:h("use",{xlinkHref:"#chrome-tab-geometry-left"})}),h("clipPath",{id:"crop",children:h("rect",{className:"mask",width:"100%",height:"100%",x:"0"})})]}),h("svg",{width:"52%",height:"100%",children:h("use",{xlinkHref:"#chrome-tab-geometry-left",width:"214",height:"36",className:e.tabGeometry})}),h("g",{transform:"scale(-1, 1)",children:h("svg",{width:"52%",height:"100%",x:"-100%",y:"0",children:h("use",{xlinkHref:"#chrome-tab-geometry-right",width:"214",height:"36",className:e.tabGeometry})})})]}),$e=Se.jsx,Ve=Se.jsxs;var Je=m.exports.forwardRef((function(e,a){return Ve("svg",l(o({},Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:a},e)),{children:[$e("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),$e("path",{fillRule:"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z",clipRule:"evenodd"})]}))})),We=Se.jsx;var ze=m.exports.forwardRef((function(e,a){return We("svg",l(o({},Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:a},e)),{children:We("path",{fillRule:"evenodd",d:"M3 3a1 1 0 00-1 1v12a1 1 0 102 0V4a1 1 0 00-1-1zm10.293 9.293a1 1 0 001.414 1.414l3-3a1 1 0 000-1.414l-3-3a1 1 0 10-1.414 1.414L14.586 9H7a1 1 0 100 2h7.586l-1.293 1.293z",clipRule:"evenodd"})}))}));var Ke={joinMoreTab:"mqik-579f2c9b",modalJoinMore:"mqik-b301ce1b",modalOverlay:"mqik-d7c925b5",modalTrickCenter:"mqik-4c6ca5b9",modalCard:"mqik-5ec79ea9",modalHeader:"mqik-5a7da58b",modalCardTitle:"mqik-23f44451",closeBtn:"mqik-6942a1a8",modalButton:"mqik-5a3020e7",modalButtonIcon:"mqik-9f4301f3",modalBody:"mqik-4500a791",loader:"mqik-4b96749a",channelListView:"mqik-b182efcc",itemView:"mqik-5f708c87",channelDetail:"mqik-dfa436ad",channelName:"mqik-efed7250",channelPurpose:"mqik-74c55633",channelActions:"mqik-b426946a",channelBtn:"mqik-cfb2aa5d",channelJoined:"mqik-381752da",buttonGroup:"mqik-1669d815",buttonGroupItem:"mqik-729f13b4",buttonView:"mqik-550de176",buttonExit:"mqik-f0e8f211"},Ye=e=>{const[a,n]=m.exports.useState(e.channelJoinned),[t,s]=m.exports.useState([]);return m.exports.useEffect((()=>{a.length!==e.channelJoinned.length&&n(e.channelJoinned)}),[e.channelJoinned]),d("div",{className:Ke.channelListView,children:[e.channels.length?h(m.exports.Fragment,{}):h("p",{className:Ke.noChannels,children:"Hiện tại không có Nhóm nào để bạn tham gia!"}),e.channels.map(((r,i)=>d("div",{className:Ke.itemView,children:[h("div",{className:Ke.channelAvatar,children:h(Ue,{src:q.getChannelPictureUrl(r.id,r.last_picture_update),size:"xl",status:"",wrapperClass:Ke.channelAvatarPicture,newStatusIcon:!1})}),d("div",{className:Ke.channelDetail,children:[h("h3",{className:Ke.channelName,children:r.display_name}),h("p",{className:Ke.channelPurpose,children:r.purpose})]}),h("div",{className:Ke.channelActions,children:a.includes(r.id)?d("div",{className:Ke.buttonGroup,children:[d("button",{className:u(Ke.buttonGroupItem,Ke.buttonView),onClick:()=>e.onView(r.name),children:[h(Je,{className:"u3-w-4 u3-h-4"}),h("span",{children:"Xem"})]}),h("button",{className:u(Ke.buttonGroupItem,Ke.buttonExit),onClick:()=>e.onExit(r.id),children:h(ze,{className:"u3-w-4 u3-h-4"})})]}):h("button",{className:Ke.channelBtn,onClick:()=>(async r=>{if(t.includes(r))return;s([...t,r]),await e.onJoin(r),n([...a,r]);let i=t.indexOf(r);t.splice(i,1),s(t)})(r.id),children:t.includes(r.id)?"Đang vào...":"Tham gia"})})]},`${i}-${r.id}`)))]})};const Ze=p.forwardRef(((e,a)=>{const[n,t]=m.exports.useState(!1),[s,r]=m.exports.useState(!1),[i,o]=m.exports.useState([]),l=T(e.currentUser),c=f();function p(){t(!1)}m.exports.useEffect((()=>{!l&&n&&(async(a,n)=>{s&&r(!1),n.length||r(!0);const{data:t}=await e.actions.fetchMyChannelsByIds(a,n);t&&o(t.channels),r(!0)})(e.teamId,e.channelIds)}),[n]);return d(m.exports.Fragment,{children:[d("div",{className:u(e.styles.tab,{[e.styles.active]:!e.currentChannelId}),ref:a,onClick:function(){c.replace(`/${e.teamName}/group`),e.actions.selectChannel("")},children:[h("div",{className:e.styles.divider}),h("div",{className:e.styles.background,children:h(Ge,{tabGeometry:e.styles.tabGeometry})}),h(Be,{placement:"top",content:"Tham gia nhóm",offset:4,delayWith:"offsetLeft",children:h("div",{className:e.styles.content,children:h(xe,{className:u("u3-mx-0",e.styles.plusIcon)})})})]}),h(Fe,{appear:!0,show:n,as:m.exports.Fragment,children:h(Ie,{as:"div",className:Ke.modalJoinMore,onClose:p,children:d("div",{className:"u3-min-h-screen u3-px-4 u3-text-center",children:[h(Fe.Child,{as:m.exports.Fragment,enter:"u3-ease-out u3-duration-300",enterFrom:"u3-opacity-0",enterTo:"u3-opacity-100",leave:"u3-ease-in u3-duration-200",leaveFrom:"u3-opacity-100",leaveTo:"u3-opacity-0",children:h(Ie.Overlay,{className:Ke.modalOverlay})}),h("span",{className:Ke.modalTrickCenter,"aria-hidden":"true",children:"​"}),h(Fe.Child,{as:m.exports.Fragment,enter:"u3-ease-out u3-duration-300",enterFrom:"u3-opacity-0 u3-scale-95",enterTo:"u3-opacity-100 u3-scale-100",leave:"u3-ease-in u3-duration-200",leaveFrom:"u3-opacity-100 u3-scale-100",leaveTo:"u3-opacity-0 u3-scale-95",children:d("div",{className:Ke.modalCard,children:[d("div",{className:Ke.modalHeader,children:[h(Ie.Title,{as:"h3",className:Ke.modalCardTitle,children:"Danh sách nhóm"}),h("div",{className:Ke.closeBtn,children:h("button",{type:"button",className:u(Ke.modalButton),onClick:p,children:h(we,{className:Ke.modalButtonIcon})})})]}),l?d("div",{className:Ke.modalBody,children:[d("p",{children:["Bạn đang là ",h("strong",{children:"Khách"}),"."]}),h("p",{children:"Vui lòng Đăng nhập để sử dụng tính năng này!"})]}):h("div",{className:Ke.modalBody,children:s?h(Ye,{teamName:e.teamName,channels:i,channelJoinned:e.channelJoinned,onJoin:function(a){return e.actions.joinChannelIntegrated(e.currentUser.id,e.teamId,a,"")},onView:function(a){p(),c.push(`/${e.teamName}/group/${a}`)},onExit:async a=>{const{data:{nextPage:n}}=await e.actions.leaveChannel(a);n&&c.replace(n)}}):h("div",{className:Ke.loader,children:h(Me,{})})})]})})]})})})]})}));var Qe=b((function(e){const a=E(e),n=A(e),t=H(e),s=P(e,"all"),r=L(e),i=j(e);return{currentUser:n,channelJoinned:s,channelIds:t,teamId:a,teamName:r.name,currentChannelId:i}}),(function(e){return{actions:v({fetchMyChannelsByIds:O,joinChannelIntegrated:D,leaveChannel:_,selectChannel:S},e)}}),null,{forwardRef:!0})(Ze);var Xe={channelInfo:"mqik-611fe298"};const ea={singleline:!1,mentionHighlight:!1};class aa extends p.PureComponent{constructor(e){super(e),c(this,"onHide",(()=>{this.setState({show:!1})})),c(this,"handleFormattedTextClick",(e=>U(e,this.props.currentRelativeTeamUrl))),c(this,"getHeaderMarkdownOptions",B((e=>l(o({},ea),{channelNamesMap:e})))),this.state={show:!0}}componentDidUpdate(e){var a,n;const t=!e.isRHSOpen&&this.props.isRHSOpen,s=(null==(a=e.channel)?void 0:a.id)!==(null==(n=this.props.currentChannel)?void 0:n.id);(t||s)&&this.onHide()}render(){let e=this.props.channel;const a=0!==e.delete_at;if(!e){const a=F("channel_info.notFound","No Channel Found");e={display_name:a,name:a,purpose:a,header:a,id:a,team_id:a,type:a,delete_at:0,create_at:0,update_at:0,last_post_at:0,total_msg_count:0,total_msg_count_root:0,extra_update_at:0,creator_id:a,scheme_id:a,group_constrained:!1,last_picture_update:0,verified:!1}}const n=this.props.channel.props&&this.props.channel.props.channel_mentions;a||"O"===e.type||e.type;const t=G()+"/"+this.props.currentTeam.name+"/group/"+e.name;let s,r;e.purpose?s=e.purpose:e.name===$.DEFAULT_CHANNEL&&(s=h(y,{id:"default_channel.purpose",defaultMessage:"Post messages here that you want everyone to see. Everyone automatically becomes a permanent member of this channel when they join the team."})),s&&(r=d("div",{className:"form-group",children:[h("div",{className:"info__label",children:h(y,{id:"channel_info.purpose",defaultMessage:"Purpose:"})}),h("div",{className:"info__value",children:s})]}));let i=null;return e.header&&(i=d("div",{className:"form-group",children:[h("div",{className:"info__label",children:h(y,{id:"channel_info.header",defaultMessage:"Header:"})}),h("div",{onClick:this.handleFormattedTextClick,className:"info__value",children:h(Re,{message:e.header,options:this.getHeaderMarkdownOptions(n)})})]})),d(qe,{dialogClassName:"",show:this.state.show,onHide:this.onHide,onExited:this.props.onHide,children:[d(Te,{closeButton:!0,onClose:this.onHide,children:[h(y,{id:"channel_info.about",defaultMessage:"Nhóm"}),h("span",{dangerouslySetInnerHTML:{__html:"&nbsp;"}}),e.display_name]}),d(Ee,{children:[d("div",{className:Xe.channelInfo,children:[h("div",{className:u(Xe.firstRow,Xe.formGroup)}),h("div",{className:Xe.formGroup})]}),r,i,d("div",{className:"form-group",children:[h("div",{className:"info__label",children:h(y,{id:"channel_info.url",defaultMessage:"URL:"})}),h("div",{className:"info__value",children:t})]}),h("div",{className:"about-modal__hash form-group pt-3",children:d("p",{children:[h(y,{id:"channel_info.id",defaultMessage:"ID: "}),e.id]})})]})]})}}c(aa,"propTypes",{onHide:g.func.isRequired,channel:g.object.isRequired,currentChannel:g.object.isRequired,currentTeam:g.object.isRequired,isRHSOpen:g.bool,currentRelativeTeamUrl:g.string});var na=b((function(e){return{isRHSOpen:V(e),currentRelativeTeamUrl:J(e),currentChannel:W(e),currentTeam:L(e)}}))(aa);var ta="mqik-b1a11290",sa="mqik-5d96f235",ra=({children:e})=>h(Fe,{as:m.exports.Fragment,enter:"u3-transition u3-ease-out u3-duration-100",enterFrom:"u3-transform u3-opacity-0 u3-scale-95",enterTo:"u3-transform u3-opacity-100 u3-scale-100",leave:"u3-transition u3-ease-in u3-duration-75",leaveFrom:"u3-transform u3-opacity-100 u3-scale-100",leaveTo:"u3-transform u3-opacity-0 u3-scale-95",children:e}),ia=e=>d(Le,{as:"div",className:e.stylex.close,children:[h(Le.Button,{children:h(je,{className:e.stylex.closeIcon})}),h(ra,{children:h(Le.Items,{className:ta,children:h(oa,{stylex:e.stylex,channel:e.channel,isMobile:!1})})})]});const oa=b((e=>({user:A(e),isArchived:Y(e),isDefault:Z(e)})))((e=>{const{channel:a,isArchived:n,isDefault:t}=e,s=a.type===$.PRIVATE_CHANNEL?K.MANAGE_PRIVATE_CHANNEL_MEMBERS:K.MANAGE_PUBLIC_CHANNEL_MEMBERS;return h(m.exports.Fragment,{children:h("div",{className:sa,children:d(Ae,{channelId:a.id,teamId:a.team_id,permissions:[s],children:[h(He,{id:"channelViewInfo",show:a.type!==$.DM_CHANNEL&&a.type!==$.GM_CHANNEL,modalId:z.CHANNEL_INFO,dialogType:na,dialogProps:{channel:a},text:F("navbar.viewInfo","View Info")}),h(He,{id:"channelManageMembers",show:a.type!==$.DM_CHANNEL&&a.type!==$.GM_CHANNEL&&!n&&!t,modalId:z.CHANNEL_MEMBERS,dialogType:Pe,dialogProps:{channel:a},text:F("channel_header.manageMembers","Manage Members")})]})})})}));var la=Se.jsx,ca=Se.jsxs;var da=m.exports.forwardRef((function(e,a){return ca("svg",l(o({},Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:a},e)),{children:[la("path",{d:"M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z"}),la("path",{fillRule:"evenodd",d:"M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z",clipRule:"evenodd"})]}))}));var ha="mqik-c47132a1",ma="mqik-f7299146";function ua(e,a,n){return e&&Boolean(e.message.trim()||e.fileInfos.length||e.uploadsInProgress.length)&&a!==(null==n?void 0:n.id)}var pa=b((function(e,a){var n;const t=j(e);return{hasDraft:ua(!!(null==(n=a.channel)?void 0:n.id)&&Q(e,X.DRAFT,a.channel.id),t,a.channel)}}),(function(e){return{actions:v({},e)}}))((e=>0!==e.channel.delete_at?h(Oe,{className:u(ha,ma)}):e.hasDraft?h(da,{className:u(ha,ma)}):e.icon));var fa="mqik-22b0f324",ba="mqik-afa6b0a9",va="mqik-2f0cc8e8",ga="mqik-49bfa606",ya="mqik-013daa6f",Na="mqik-133903d4";class Ca extends p.PureComponent{constructor(e){super(e),c(this,"labelRef"),c(this,"gmItemRef"),c(this,"enableToolTipIfNeeded",(()=>{const e=this.gmItemRef.current||this.labelRef.current,a=e&&e.offsetWidth<e.scrollWidth;this.setState({showTooltip:Boolean(a)})})),c(this,"getAriaLabel",(()=>{const{label:e,ariaLabelPrefix:a,unreadMentions:n}=this.props;let t=e;return a&&(t+=` ${a}`),1===n?t+=` ${n} ${F("accessibility.sidebar.types.mention","mention")}`:n>1&&(t+=` ${n} ${F("accessibility.sidebar.types.mentions","mentions")}`),this.showChannelAsUnread()&&0===n&&(t+=` ${F("accessibility.sidebar.types.unread","unread")}`),t.toLowerCase()})),c(this,"removeTooltipLink",(()=>{var e,a;return null==(a=null==(e=this.gmItemRef.current)?void 0:e.removeAttribute)?void 0:a.call(e,"aria-describedby")})),c(this,"handleMenuToggle",(e=>this.setState({isMenuOpen:e}))),c(this,"showChannelAsUnread",(()=>this.props.unreadMentions>0||this.props.unreadMsgs>0&&this.props.showUnreadForMsgs)),this.labelRef=p.createRef(),this.gmItemRef=p.createRef(),this.state={isMenuOpen:!1,showTooltip:!0}}componentDidMount(){this.enableToolTipIfNeeded()}componentDidUpdate(e){e.label!==this.props.label&&this.enableToolTipIfNeeded()}render(){const{link:e,label:a,channel:n,currentChannelId:t,icon:s,memberCount:r,isMuted:i,canManage:o,styles:l}=this.props;let c=null;return t===n.id&&o&&(c=h(ia,{stylex:l,channel:n})),h(m.exports.Fragment,{children:d(N,{className:u(l.content,ya),to:e,"aria-label":this.getAriaLabel(),title:a,children:[h("div",{className:u(l.icon,Na),children:h(pa,{channel:n,icon:s})}),h("div",{className:u(l.title,fa,{[va]:i,[ba]:this.showChannelAsUnread(),[ga]:0!==n.delete_at}),children:a}),null,c]})})}}var _a=b((function(e,a){const n=ee(e)[a.channel.id],t=j(e),s=ae(e);let r=null;s[a.channel.id]&&(r=s[a.channel.id]);let i=0,o=0,l=!0;const c=ne(e),d=te(e);return n&&(i=c?n.mention_count_root:n.mention_count,a.channel&&(o=se(c,a.channel,n)),n.notify_props&&(l=n.notify_props.mark_unread!==re.MENTION)),{unreadMentions:i,unreadMsgs:o,showUnreadForMsgs:l,isMuted:ie(n),memberCount:r?r.member_count-r.guest_count:-1,canManage:d,currentChannelId:t}}),(function(e){return{actions:v({getChannelStats:oe},e)}}))(Ca);var ka=b(null,(function(e){return{actions:v({leaveChannel:x},e)}}))((e=>{const a=()=>{e.actions.leaveChannel(e.channel.id)},n=()=>{k({id:e.channel.id,display_name:e.channel.display_name})};let t;e.channel.type===$.OPEN_CHANNEL?t=F("accessibility.sidebar.types.public","public channel"):e.channel.type===$.PRIVATE_CHANNEL&&(t=F("accessibility.sidebar.types.private","private channel"));const{channel:s,currentTeamName:r,styles:i}=e;return h(_a,{channel:s,styles:i,link:`/${r}/group/${s.name}`,label:s.display_name,ariaLabelPrefix:t,closeHandler:(()=>{const{channel:t}=e;return t.type===$.OPEN_CHANNEL&&t.name!==$.DEFAULT_CHANNEL?a:t.type===$.PRIVATE_CHANNEL?n:null})(),icon:(()=>{const{channel:a}=e;return h(Ue,{src:q.getChannelPictureUrl(a.id,a.last_picture_update),size:"tab",status:"",wrapperClass:"",newStatusIcon:!0})})()})}));var xa=C((e=>{const{channel:a,teammate:n,currentTeamName:t,currentUserId:s,intl:r}=e;if(!n)return null;let i=a.display_name;return s===n.id&&(i=r.formatMessage({id:"sidebar.directchannel.you",defaultMessage:"{displayname} (you)"},{displayname:i})),h(_a,{teammateId:n.id,channel:a,link:`/${t}/messages/@${n.username}`,label:i,closeHandler:a=>{const n=e.channel.teammate_id,t=$.Preferences.CATEGORY_DIRECT_CHANNEL_SHOW,s=e.currentUserId;e.actions.savePreferences(s,[{user_id:s,category:t,name:n,value:"false"}]).then(a),e.actions.leaveDirectChannel(e.channel.name),e.active&&le.push(`#u3-app/${e.currentTeamName}/group/${e.redirectChannel}`)},icon:(()=>{const{channel:a,teammate:n}=e;if(!n)return null;if(n.id&&n.delete_at)return h("i",{className:"icon icon-archive-outline"});let t="";return"online"===a.status?t="status-online":"away"===a.status?t="status-away":"dnd"===a.status&&(t="status-dnd"),h(Ue,{src:q.getProfilePictureUrl(n.id,n.last_picture_update),size:"tab",status:n.is_bot?"":a.status,wrapperClass:"DirectChannel__profile-picture",newStatusIcon:!1,statusClass:`DirectChannel__status-icon ${t}`})})(),styles:e.styles})}));var Ia=b((function(e,a){const n=ce(e,a.channel.teammate_id),t=A(e),s=L(e),r=de(e,s.id),i=j(e),o=a.channel.id===i;return{teammate:n,currentUserId:t.id,redirectChannel:r,active:o}}),(function(e){return{actions:v({savePreferences:he,leaveDirectChannel:I},e)}}))(xa);class wa extends p.PureComponent{constructor(){super(...arguments),c(this,"handleLeaveChannel",(e=>{const a=this.props.channel.id,n=$.Preferences.CATEGORY_GROUP_CHANNEL_SHOW,t=this.props.currentUserId;this.props.actions.savePreferences(t,[{user_id:t,category:n,name:a,value:"false"}]).then(e),this.props.active&&le.push(`#u3-app/${this.props.currentTeamName}/group/${this.props.redirectChannel}`)})),c(this,"getIcon",(()=>h("div",{className:"status status--group",children:this.props.membersCount})))}render(){const{channel:e,currentTeamName:a,styles:n}=this.props;return h(_a,{channel:e,link:`/${a}/messages/${e.name}`,label:e.display_name,closeHandler:this.handleLeaveChannel,icon:this.getIcon(),styles:n})}}var Ma=b((function(e,a){const n=A(e),t=L(e),s=de(e,t.id),r=j(e),i=a.channel.id===r,o=me(e);let l=0;if(o&&o[a.channel.id]){const e=o[a.channel.id];l=e.size,e.has(n.id)&&l--}return{currentUserId:n.id,redirectChannel:s,active:i,membersCount:l}}),(function(e){return{actions:v({savePreferences:he},e)}}))(wa);var Ra={itemTabChannel:"mqik-aef0f632",tab:"mqik-636eaf61",divider:"mqik-8894bce1",background:"mqik-d23cabb8",tabGeometry:"mqik-3f282ffb",active:"mqik-04826ad9",justAdded:"mqik-9a5930be",tabWasJustAdded:"mqik-eafa980b",content:"mqik-70df9724",icon:"mqik-9cb71bdb",title:"mqik-a034c782",badge:"mqik-b324cfe6",close:"mqik-cece8b76",closeIcon:"mqik-9bf0a77c"};const qa=m.exports.forwardRef(((e,a)=>{if(!e.channel)return null;let n=ka;return e.channel.type===$.DM_CHANNEL?n=Ia:e.channel.type===$.GM_CHANNEL&&(n=Ma),d("div",{ref:a,className:u(Ra.tab,{[Ra.active]:e.isCurrentChannel}),children:[h("div",{className:Ra.divider}),h("div",{className:Ra.background,children:h(Ge,{tabGeometry:Ra.tabGeometry})}),h(n,{channel:e.channel,currentTeamName:e.currentTeamName,styles:Ra})]})}));var Ta=b(function(){const e=ue();return(a,n)=>{const t=e(a,{id:n.channelId}),s=L(a),r=ee(a)[n.channelId],i=j(a);let o=0,l=0,c=!0;return r&&(o=r.mention_count,t&&(l=se(!1,t,r)),r.notify_props&&(c=r.notify_props.mark_unread!==re.MENTION)),{channel:t,currentTeamName:s.name,isCurrentChannel:t.id===i,unreadMentions:o,unreadMsgs:l,showUnreadForMsgs:c}}}(),null,null,{forwardRef:!0})(qa);var Ea={items:"mqik-de39095c",listItems:"mqik-f90cfba6",chromeTabs:"mqik-0ba29205",chromeContent:"mqik-ccf8ee20",tab:"mqik-06382617",divider:"mqik-18a40aa8",background:"mqik-726bf2a2",tabGeometry:"mqik-a8269bbb",active:"mqik-5a764161",justAdded:"mqik-d113a3d5",tabWasJustAdded:"mqik-146f5b8a",content:"mqik-c9390443",icon:"mqik-fae86490",title:"mqik-20552f1b",badge:"mqik-f73abad0",close:"mqik-a67f3ebe",closeIcon:"mqik-a004418d",plusIcon:"mqik-bf387a6e",bottomBar:"mqik-9b0723b5"};class Aa extends p.PureComponent{constructor(e){super(e),c(this,"chromeTabsRef"),c(this,"tabsContentRef"),c(this,"joinMoreRef"),c(this,"tabItemRefs"),c(this,"layoutTabsDebounce"),c(this,"firstLoad"),c(this,"refKey",(e=>`refKey_${e}`)),c(this,"handleTabItemRef",(e=>a=>{this.tabItemRefs.set(this.refKey(e),a),this.layoutTabsDebounce()})),this.chromeTabsRef=m.exports.createRef(),this.tabsContentRef=m.exports.createRef(),this.joinMoreRef=m.exports.createRef(),this.tabItemRefs=new Map,this.firstLoad=!0,this.layoutTabsDebounce=w((()=>{this.layoutTabs(this.props.channelIds),this.firstLoad=!1}),50)}componentDidMount(){var e;null==(e=this.chromeTabsRef.current)||e.style.setProperty("--tab-content-margin","9px")}componentWillUnmount(){var e;null==(e=this.chromeTabsRef.current)||e.style.removeProperty("--tab-content-margin"),this.tabItemRefs.clear()}get tabContentWidths(){var e;const a=this.props.channelIds.length,n=(null==(e=this.tabsContentRef.current)?void 0:e.clientWidth)||0,t=1*(a+1-1),s=(n-18+t-52)/a,r=Math.max(24,Math.min(196,s)),i=Math.floor(r),o=[];let l=n-(i*a+18-t+52);for(let c=0;c<a+1;c+=1){const e=i<196&&l>0?1:0;c<a?o.push(i+e):o.push(52),l>0&&(l-=1)}return o}get tabContentPositions(){const e=[],a=this.tabContentWidths;let n=9;return a.forEach(((a,t)=>{const s=1*t;e.push(n-s),n+=a})),e}get tabPositions(){const e=[];return this.tabContentPositions.forEach((a=>{e.push(a-9)})),e}layoutTabs(e){const a=this.tabContentWidths,n=this.tabPositions;e.forEach(((e,t)=>{const s=a[t],r=s+18,i=this.tabItemRefs.get(this.refKey(e));if(i){i.style.width=r+"px",i.removeAttribute("small"),i.removeAttribute("smaller"),i.removeAttribute("mini"),s<84&&i.setAttribute("small",""),s<60&&i.setAttribute("smaller",""),s<48&&i.setAttribute("mini","");const e=n[t];i.style.left=`${e}px`}})),this.joinMoreRef.current&&(this.joinMoreRef.current.style.width="52px",this.joinMoreRef.current.style.left=`${n[n.length-1]}px`,this.joinMoreRef.current.style.display="block")}render(){const{channelIds:e}=this.props;return d("div",{ref:this.chromeTabsRef,className:Ea.chromeTabs,children:[d("div",{ref:this.tabsContentRef,className:Ea.chromeContent,children:[e.map(((e,a)=>h(Ta,{ref:this.handleTabItemRef(e),channelIndex:a,channelId:e},e))),h(Qe,{ref:this.joinMoreRef,styles:Ea})]}),h("div",{className:Ea.bottomBar})]})}}var Ha=b(function(){const e=Ce(),a=_e(),n=ke();return t=>{const s=pe(t),r=fe(t,s),i=be(t,s),o=P(t,s),l=1===ve(t);if("all"===s||i.type===ge.DIRECT_MESSAGES){let s=o.reduce(((e,a)=>{const n=ye(t,a);return n&&n.type===Ne.PRIVATE_CHANNEL&&e.push(n),e}),[]);return s=e(t,s),s=a(t,s),s=n(t,s),{channelIds:s.map((e=>e.id)),categoryLoading:l,sidebarIndex:r}}return{channelIds:[],categoryLoading:l,sidebarIndex:r}}}())(Aa);var Pa="mqik-5d502d38",La="mqik-98b0c3b7";var ja=b()((()=>(m.exports.useRef(null),h("div",{className:Pa,children:h("div",{className:La,children:h(Ha,{})})}))));var Oa="mqik-d7cbc3e0";var Da=e=>{const[a,n]=m.exports.useState(!0);m.exports.useEffect((()=>{e.teamId&&(a||n(!0),e.actions.loadChannelsForCurrentUser2().then((()=>{n(!1)})))}),[e.teamId]);return a?h(De,{}):h("div",{className:Oa,children:h(ja,{onJoinMore:()=>{}})})};var Sa=b((function(e){const a=L(e),n=A(e);return{teamId:a.id,currentUser:n}}),(function(e){return{actions:v({loadChannelsForCurrentUser2:M},e)}}))(Da);var Ua=b((function(e){return{}}),(function(e){return{actions:v({receivedEvent:R},e)}}))((function(e){return m.exports.useEffect((()=>{window.quikExternalEvent(e.location.state)}),[]),d(m.exports.Fragment,{children:[h("div",{children:"OK 123"}),h(Sa,{})]})}));export{Ua as default};
